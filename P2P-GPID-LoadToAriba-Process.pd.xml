<process xmlns="http://schemas.active-endpoints.com/appmodules/screenflow/2010/10/avosScreenflow.xsd" xmlns:types1="http://schemas.active-endpoints.com/appmodules/repository/2010/10/avrepository.xsd" xmlns:aetgt="http://schemas.active-endpoints.com/appmodules/repository/2010/10/avrepository.xsd" xmlns:list="urn:activevos:spi:list:functions" name="P2P-GPID-LoadToAriba-Process"><appliesTo/><description>Process to Load Files to Ariba</description><tags>P2P,.agent:eccvas3564</tags><generator>Informatica Process Designer 8</generator><input><parameter name="fileEvent" type="reference"><options><option name="required">false</option><option name="referenceTo">P2P-FileWatcher:AttachmentFileContent</option><option name="isCopy">true</option></options></parameter></input><tempFields><field name="tmpEmail" type="reference"><options><option name="referenceTo">EmailConnection-SendAttachments:EmailTaskInput</option><option name="required">false</option><option name="isCopy">true</option></options></field><field name="tmpDB_Realm" type="reference"><options><option name="referenceTo">cn-JDBC-SQL-AuroraDS-Database:ARIBA_FILE_REALM</option><option name="required">false</option></options></field><field name="tmp_Realm" type="string"><options><option name="required">false</option></options></field><field name="tmp_ZipFileNmConstnt" type="string"><options><option name="required">false</option></options></field></tempFields><notes/><deployment suspendOnFault="false" tracingLevel="verbose"><targetLocation>eccvas3564</targetLocation><event eventSource="P2P-FileWatcher:P2P-GPID-OutFileToAriba"/></deployment><flow id="a"><start id="b"><link id="link1" targetId="c"/></start><wait id="c"><title>Wait for 10 Seconds</title><duration source="formula"><function name="duration_expression"><arg name="value">10</arg><arg name="scale">S</arg><arg name="businessDays"/></function></duration><link id="jgz66sjm" targetId="jgz66sjl"/></wait><assignment id="jgz66sjl"><title>Input FileName</title><operation source="formula" to="temp.tmp_ZipFileNmConstnt"><expression language="XQuery">fn:substring($input.fileEvent[1]/fileInfo[1]/name, 1, fn:string-length($input.fileEvent[1]/fileInfo[1]/name)-15)</expression></operation><link id="jgz66sjn" targetId="jgy0b93t"/></assignment><assignment id="jgy0b93t"><title>Get File Upload Realm</title><operation source="query" to="temp.tmpDB_Realm"><query from="cn-JDBC-SQL-AuroraDS-Database:ARIBA_FILE_REALM"><where>ZIPFILENM_CONSTANT = '{$temp.tmp_ZipFileNmConstnt}'</where></query></operation><link id="jgz66skk" targetId="jgz66skj"/></assignment><container id="jgz66skj" type="exclusive"><title>Realm Exists?</title><flow id="jgz66skq"><container id="jgz66sn5" type="exclusive"><title>REALM</title><flow id="jh0teavw"><eventContainer id="jhhr7j6s"><service id="jh0teb0m"><title>UploadFile To ParentRealM</title><serviceName>Ariba-Connector:UploadFileToParentRealM</serviceName><serviceInput><parameter name="event" source="constant">Import Batch Data</parameter><parameter name="fullload" source="constant">false</parameter><parameter name="content" source="field" updatable="true">input.fileEvent[1]/attachment</parameter><parameter name="clienttype" source="constant">ICRT</parameter><parameter name="clientinfo" source="constant">Informatica</parameter><parameter name="clientversion" source="constant">Spring2018</parameter></serviceInput></service><flow id="jhhr7j6v"><container id="jhhr7jaq" type="exclusive"><title>Parent Upload Status Code</title><flow id="jhhr7jar"><wait id="jhhr7jas"><title>Wait for 10 Secs Before Retry</title><duration source="formula"><function name="duration_expression"><arg name="value">10</arg><arg name="scale">S</arg><arg name="businessDays"/></function></duration><link id="jhhr7jbb" targetId="jhhr7jat"/></wait><jumpTo id="jhhr7jat"><link id="jhhr7jbc" targetId="jhhr7j6s"/></jumpTo></flow><flow id="jhhr7jau"><assignment id="jhhr7jav"><title>emailObject</title><operation source="constant" to="temp.tmpEmail[1]/to">asing183@ford.com,isiddiq6@ford.com,rbhagat1@ford.com</operation><operation source="constant" to="temp.tmpEmail[1]/subject">P2P GPID Upload to Parent Realm failed</operation><operation source="constant" to="temp.tmpEmail[1]/body">Failed upload for File:- {$input.fileEvent[1]/fileInfo[1]/fullName} 
Reason:- Bad credentials -- wrong shared secret. 
The shared secret configured is null or does not match the one configured on the server.</operation><link id="jhhr7jbd" targetId="jhhr7jaw"/></assignment><service id="jhhr7jaw"><title>Email Notification</title><serviceName>EmailConnection-SendAttachments:sendEmailService</serviceName><serviceInput><parameter name="emailTaskInput" source="field" updatable="true">temp.tmpEmail</parameter></serviceInput><link id="jhhr7jbe" targetId="jhhr7jax"/></service><end id="jhhr7jax"/></flow><flow id="jhhr7jay"><end id="jhhr7jaz"/></flow><flow id="jhhr7jb0"><assignment id="jhhr7jb1"><title>emailObject</title><operation source="constant" to="temp.tmpEmail[1]/to">asing183@ford.com,isiddiq6@ford.com,rbhagat1@ford.com</operation><operation source="constant" to="temp.tmpEmail[1]/subject">P2P GPID Upload to Parent Realm failed</operation><operation source="constant" to="temp.tmpEmail[1]/body">Failed upload for File:- {$input.fileEvent[1]/fileInfo[1]/fullName} 
Reason:- Ariba Internal Server Error.
Ariba Application Not available.</operation><link id="jhhr7jbf" targetId="jhhr7jb2"/></assignment><service id="jhhr7jb2"><title>Email Notification</title><serviceName>EmailConnection-SendAttachments:sendEmailService</serviceName><serviceInput><parameter name="emailTaskInput" source="field" updatable="true">temp.tmpEmail</parameter></serviceInput><link id="jhhr7jbg" targetId="jhhr7jb3"/></service><end id="jhhr7jb3"/></flow><flow id="jhhr7jb4"><end id="jhhr7jb5"/></flow><link id="jhhr7jb6" targetId="jhhr7jar" type="containerLink"><condition source="formula"><function name="equals"><arg name="left">{$output.ParentStatusCode}</arg><arg name="right">{503}</arg></function></condition></link><link id="jhhr7jb7" targetId="jhhr7jau" type="containerLink"><condition source="formula"><function name="equals"><arg name="left">{$output.ParentStatusCode}</arg><arg name="right">{401}</arg></function></condition></link><link id="jhhr7jb8" targetId="jhhr7jay" type="containerLink"><condition source="formula"><function name="equals"><arg name="left">{$output.ParentStatusCode}</arg><arg name="right">{200}</arg></function></condition></link><link id="jhhr7jb9" targetId="jhhr7jb0" type="containerLink"><condition source="formula"><function name="equals"><arg name="left">{$output.ParentStatusCode}</arg><arg name="right">{500}</arg></function></condition></link><link id="jhhr7jba" targetId="jhhr7jb4" type="containerLink"/></container></flow><flow id="jhhr7j6z"><container id="jhhr7j6y" type="exclusive"><title>Fault Code</title><flow id="jhhr7j7e"><wait id="jhhr7j7d"><title>Wait 10 Secs</title><duration source="formula"><function name="duration_expression"><arg name="value">10</arg><arg name="scale">S</arg><arg name="businessDays"/></function></duration><link id="jhhr7j9w" targetId="jhhr7j9v"/></wait><jumpTo id="jhhr7j9v"><link id="jhhr7ja9" targetId="jhhr7j6s"/></jumpTo></flow><flow id="jhhr7j7h"><assignment id="jhhr7j8k"><title>emailObject</title><operation source="constant" to="temp.tmpEmail[1]/to">asing183@ford.com,isiddiq6@ford.com,rbhagat1@ford.com</operation><operation source="constant" to="temp.tmpEmail[1]/subject">P2P GPID Upload to Child Realm failed</operation><operation source="constant" to="temp.tmpEmail[1]/body">Failed upload for File:- {$input.fileEvent[1]/fileInfo[1]/fullName} 
Reason:- {$output.ParentFault[1]/reason} </operation><link id="jhhr7j8l" targetId="jhhr7j7z"/></assignment><service id="jhhr7j7z"><title>Email Notification</title><serviceName>EmailConnection-SendAttachments:sendEmailService</serviceName><serviceInput><parameter name="emailTaskInput" source="field" updatable="true">temp.tmpEmail</parameter></serviceInput><link id="jhhr7j9f" targetId="jhhr7j9e"/></service><end id="jhhr7j9e"/></flow><link id="jhhr7j7b" targetId="jhhr7j7e" type="containerLink"><condition source="formula"><function name="contains"><arg name="left">{$output.ParentFault[1]/code}</arg><arg name="right">HTTP_503</arg></function></condition></link><link id="jhhr7j7c" targetId="jhhr7j7h" type="containerLink"/></container></flow><link id="jhhr7j6t" targetId="jhhr7j6v" type="containerLink"/><events><catch faultField="ParentFault" id="jhhr7j6l" interrupting="true"><link id="jhhr7j6x" targetId="jhhr7j6z" type="containerLink"/></catch></events></eventContainer></flow><flow id="jh0teavz"><eventContainer id="jhhr7iz2"><service id="jh0teb0f"><title>UploadFile To ChildRealM</title><serviceName>Ariba-Connector:UploadFileToChildRealM</serviceName><serviceInput><parameter name="event" source="constant">Import Batch Data</parameter><parameter name="fullload" source="constant">false</parameter><parameter name="content" source="field" updatable="true">input.fileEvent[1]/attachment</parameter><parameter name="clienttype" source="constant">ICRT</parameter><parameter name="clientinfo" source="constant">Informatica</parameter><parameter name="clientversion" source="constant">Spring2018</parameter></serviceInput></service><flow id="jhhr7iz5"><container id="jhhr7j5j" type="exclusive"><title>Child Upload Status Code</title><flow id="jhhr7j5k"><wait id="jhhr7j5l"><title>Wait for 10 Secs Before Retry</title><duration source="formula"><function name="duration_expression"><arg name="value">10</arg><arg name="scale">S</arg><arg name="businessDays"/></function></duration><link id="jhhr7j64" targetId="jhhr7j5m"/></wait><jumpTo id="jhhr7j5m"><link id="jhhr7j65" targetId="jhhr7iz2"/></jumpTo></flow><flow id="jhhr7j5n"><assignment id="jhhr7j5o"><title>emailObject</title><operation source="constant" to="temp.tmpEmail[1]/to">asing183@ford.com,isiddiq6@ford.com,rbhagat1@ford.com</operation><operation source="constant" to="temp.tmpEmail[1]/subject">P2P GPID Upload to Parent Realm failed</operation><operation source="constant" to="temp.tmpEmail[1]/body">Failed upload for File:- {$input.fileEvent[1]/fileInfo[1]/fullName} 
Reason:- Bad credentials -- wrong shared secret. 
The shared secret configured is null or does not match the one configured on the server.</operation><link id="jhhr7j9l" targetId="jhhr7j5p"/></assignment><service id="jhhr7j5p"><title>Email Notification</title><serviceName>EmailConnection-SendAttachments:sendEmailService</serviceName><serviceInput><parameter name="emailTaskInput" source="field" updatable="true">temp.tmpEmail</parameter></serviceInput><link id="jhhr7j67" targetId="jhhr7j5q"/></service><end id="jhhr7j5q"/></flow><flow id="jhhr7j5r"><end id="jhhr7j5s"/></flow><flow id="jhhr7j5t"><assignment id="jhhr7j5u"><title>emailObject</title><operation source="constant" to="temp.tmpEmail[1]/to">asing183@ford.com,isiddiq6@ford.com,rbhagat1@ford.com</operation><operation source="constant" to="temp.tmpEmail[1]/subject">P2P GPID Upload to Child Realm failed</operation><operation source="constant" to="temp.tmpEmail[1]/body">Failed upload for File:- {$input.fileEvent[1]/fileInfo[1]/fullName} 
Reason:- Ariba Internal Server Error.
Ariba Application Not available.</operation><link id="jhhr7j68" targetId="jhhr7j5v"/></assignment><service id="jhhr7j5v"><title>Email Notification</title><serviceName>EmailConnection-SendAttachments:sendEmailService</serviceName><serviceInput><parameter name="emailTaskInput" source="field" updatable="true">temp.tmpEmail</parameter></serviceInput><link id="jhhr7j69" targetId="jhhr7j5w"/></service><end id="jhhr7j5w"/></flow><flow id="jhhr7j5x"><end id="jhhr7j5y"/></flow><link id="jhhr7j5z" targetId="jhhr7j5k" type="containerLink"><condition source="formula"><function name="equals"><arg name="left">{$output.ChildStatusCode}</arg><arg name="right">{503}</arg></function></condition></link><link id="jhhr7j60" targetId="jhhr7j5n" type="containerLink"><condition source="formula"><function name="equals"><arg name="left">{$output.ChildStatusCode}</arg><arg name="right">{401}</arg></function></condition></link><link id="jhhr7j61" targetId="jhhr7j5r" type="containerLink"><condition source="formula"><function name="equals"><arg name="left">{$output.ChildStatusCode}</arg><arg name="right">{200}</arg></function></condition></link><link id="jhhr7j62" targetId="jhhr7j5t" type="containerLink"><condition source="formula"><function name="equals"><arg name="left">{$output.ChildStatusCode}</arg><arg name="right">{500}</arg></function></condition></link><link id="jhhr7j63" targetId="jhhr7j5x" type="containerLink"/></container></flow><flow id="jhhr7iz9"><container id="jhhr7iz8" type="exclusive"><title>Fault Code</title><flow id="jhhr7j2u"><wait id="jhhr7j4w"><title>Wait 10 Secs</title><duration source="formula"><function name="duration_expression"><arg name="value">10</arg><arg name="scale">S</arg><arg name="businessDays"/></function></duration><link id="jhhr7j57" targetId="jhhr7j56"/></wait><jumpTo id="jhhr7j56"><link id="jhhr7j5f" targetId="jhhr7iz2"/></jumpTo></flow><flow id="jhhr7j2x"><assignment id="jhhr7j44"><title>emailObject</title><operation source="constant" to="temp.tmpEmail[1]/to">asing183@ford.com,isiddiq6@ford.com,rbhagat1@ford.com</operation><operation source="constant" to="temp.tmpEmail[1]/subject">P2P GPID Upload to Child Realm failed</operation><operation source="constant" to="temp.tmpEmail[1]/body">Failed upload for File:- {$input.fileEvent[1]/fileInfo[1]/fullName} 
Reason:- {$output.ChildFault[1]/reason} </operation><link id="jhhr7j45" targetId="jhhr7j3j"/></assignment><service id="jhhr7j3j"><title>Email Notification</title><serviceName>EmailConnection-SendAttachments:sendEmailService</serviceName><serviceInput><parameter name="emailTaskInput" source="field" updatable="true">temp.tmpEmail</parameter></serviceInput><link id="jhhr7j4i" targetId="jhhr7j4h"/></service><end id="jhhr7j4h"/></flow><link id="jhhr7j2r" targetId="jhhr7j2u" type="containerLink"><condition source="formula"><function name="contains"><arg name="left">{$output.ChildFault[1]/code}</arg><arg name="right">HTTP_503</arg></function></condition></link><link id="jhhr7j2s" targetId="jhhr7j2x" type="containerLink"/></container></flow><link id="jhhr7iz3" targetId="jhhr7iz5" type="containerLink"/><events><catch faultField="ChildFault" id="jhhr7iyv" interrupting="true"><link id="jhhr7iz7" targetId="jhhr7iz9" type="containerLink"/></catch></events></eventContainer></flow><flow id="jh0teaw2"><end id="jh0teayr"/></flow><link id="jh0teavs" targetId="jh0teavw" type="containerLink"><condition source="formula"><function name="string-equals"><arg name="left">{$temp.tmpDB_Realm.UPLOAD_REALM}</arg><arg name="right">Parent</arg></function></condition></link><link id="jh0teavt" targetId="jh0teavz" type="containerLink"><condition source="formula"><function name="string-equals"><arg name="left">{$temp.tmpDB_Realm.UPLOAD_REALM}</arg><arg name="right">Child</arg></function></condition></link><link id="jh0teavu" targetId="jh0teaw2" type="containerLink"/></container></flow><flow id="jgz66skt"><assignment id="jgz66slt"><title>emailObjectF</title><operation source="constant" to="temp.tmpEmail[1]/to">asing183@ford.com,isiddiq6@ford.com,rbhagat1@ford.com</operation><operation source="constant" to="temp.tmpEmail[1]/subject">P2P GPID Upload Realm Not Exist</operation><operation source="constant" to="temp.tmpEmail[1]/body">Failed upload for File:- {$input.fileEvent[1]/fileInfo[1]/fullName} 
Reason:- Realm does not exist in Database, please check DB for file entry.</operation><link id="jgz66smb" targetId="jgz66sma"/></assignment><service id="jgz66sma"><title>Email Notification Fail</title><serviceName>EmailConnection-SendAttachments:sendEmailService</serviceName><serviceInput><parameter name="emailTaskInput" source="field" updatable="true">temp.tmpEmail</parameter></serviceInput><link id="jgz66smi" targetId="jgz66smh"/></service><end id="jgz66smh"/></flow><link id="jgz66skn" targetId="jgz66skq" type="containerLink"><condition source="formula"><function name="set"><arg name="field">{$temp.tmpDB_Realm}</arg></function></condition></link><link id="jgz66sko" targetId="jgz66skt" type="containerLink"><condition source="formula"><function name="unset"><arg name="field">{$temp.tmpDB_Realm}</arg></function></condition></link></container></flow></process>